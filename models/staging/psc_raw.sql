SELECT
    jsonb_extract_path_text("data",'company_number') AS "company_number",
    jsonb_extract_path_text("data",'data','etag') AS "etag",
    jsonb_extract_path_text("data",'data','kind') AS "kind",
    jsonb_extract_path_text("data",'data','name') AS "name",
    jsonb_extract_path_text("data",'data','links','self') AS "links_self",
    jsonb_extract_path_text("data",'data','address','country') AS "address_country",
    jsonb_extract_path_text("data",'data','address','locality') AS "address_locality",
    jsonb_extract_path_text("data",'data','address','premises') AS "address_premises",
    jsonb_extract_path_text("data",'data','address','postal_code') AS "address_postal_code",
    jsonb_extract_path_text("data",'data','address','address_line_1') AS "address_line_1",
    jsonb_extract_path_text("data",'data','address','address_line_2') AS "address_line_2",
    jsonb_extract_path_text("data",'data','address','region') AS "address_region",
    jsonb_extract_path_text("data",'data','address','care_of') AS "address_care_of",
    jsonb_extract_path_text("data",'data','address','po_box') AS "address_po_box",
    jsonb_extract_path_text("data",'data','notified_on') AS "notified_on",
    jsonb_extract_path_text("data",'data','ceased_on') AS "ceased_on",
    jsonb_extract_path_text("data",'data','nationality') AS "nationality",
    jsonb_extract_path_text("data",'data','date_of_birth','year')::bigint AS "date_of_birth_year",
    jsonb_extract_path_text("data",'data','date_of_birth','month')::bigint AS "date_of_birth_month",
    jsonb_extract_path_text("data",'data','name_elements','surname') AS "name_elements_surname",
    jsonb_extract_path_text("data",'data','name_elements','forename') AS "name_elements_forename",
    jsonb_extract_path_text("data",'data','name_elements','middle_name') AS "name_elements_middle_name",
    jsonb_extract_path_text("data",'data','name_elements','title') AS "name_elements_title",
    jsonb_extract_path("data",'data','natures_of_control') AS "natures_of_control",
    jsonb_extract_path_text("data",'data','country_of_residence') AS "country_of_residence",
    jsonb_extract_path_text("data",'data','identification','legal_form') AS "identification_legal_form",
    jsonb_extract_path_text("data",'data','identification','legal_authority') AS "identification_legal_authority",
    jsonb_extract_path_text("data",'data','identification','place_registered') AS "identification_place_registered",
    jsonb_extract_path_text("data",'data','identification','country_registered') AS "identification_country_registered",
    jsonb_extract_path_text("data",'data','identification','registration_number') AS "identification_registration_number"
FROM {{ source("ltrgoddard_company_data", "psc") }}
